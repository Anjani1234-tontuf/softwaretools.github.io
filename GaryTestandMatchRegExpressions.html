<!DOCTYPE HTML>
<html lang="en-us">
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<style type="text/css">
.mppad
{
  margin: 1em;
}
.aliceblue, .a
{
background-color:aliceblue;
}
.lightgray
{
background-color:lightgrey;
}
.lightskyblue, .l
{
background-color:lightskyblue;
}
p
{
font-family:"courier-new",courier,fixed;
}

</style>
<title>GaryTestandMatchRegExpression.html</title>
<link rel="StyleSheet" href="css/GaryDefault.css" type="text/css">
<meta name="keywords" content="">
<script type="text/javascript" src="js/gjcore.min.js"></script>
<script type="text/javascript" src="js/gjutil1.min.js"></script>
<script type="text/javascript" src="js/gjmsg.min.js"></script>
<script type="text/javascript">

var inStrs =
[
"abcdefghijklmnopqrstuvwxyz 0123456789 ABCDEFGHIJKLMNOPQRSTUVWXYZ",
"ÀÖØöøÿabcdefghijklmnopqrstuvwxyz 0123456789 ABCDEFGHIJKLMNOPQRSTUVWXYZ",
"abcdefghijklmnopqrstuvwxyz 0123456789 ABCDEFGHIJKLMNOPQRSTUVWXYZÀÖØöøÿ",
"GÀÖRY's Johnsonÿ hyp-name with single quote",
"Gary` accented.lastname with period",
"Anne Doherty Johnson",
"Gary < Sc Johnson",
"Gary '' Sc Johnson",
'double double quotes" "',
"'double single quotes '",
"single forward slash /",
"single backslash\\",
"Gary;Drop",
"delete drop update replace kill lock",
"<(>){}[]",
"!@#$%^&*()_+<>:''\\|",
"617-242-8721",
"011 617-242-8721",
"617-242-8721 ext 12",
"gary@johnson.com",
"gary@m.com",
"gary@.com",
"318 BUNKER HILL ST",
"CHARLESTOWN, MA 02129-1831",
"MA 02129-1831",
"http://www.garyjohnsoninfo.info",
"02129",
"02129-1831",
"s2345-d234",
"s12345-d234",
"ddddd-dddd",
"eeeee-eeee",
"empty string is next --",
"",
"12345-d234",
"987,654,000",
"987654.00",
"$987,654.00",
"02-02-02",
"01/01/2001",
"3/1/7",
"3/1/07",
"3/1/",
"ABCDEF`´„`´“”´ABCDEF•– — ™ ©®ABCDEF"
];

var inStrs2 =
[
"or 1=1",
"or 1=1--",
"or 1=1#",
"or 1=1/*",
"admin' --", //  check vulnerability for this  -- and admin
"admin' #",
"admin'/*",
"admin' or '1'='1",
"admin' or '1'='1'--",
"admin' or '1'='1'#",
"admin' or '1'='1'/*",
"admin'or 1=1 or ''='",
"admin' or 1=1",
"admin' or 1=1--",
"admin' or 1=1#",
"admin' or 1=1/*",
"admin') or ('1'='1",
"admin') or ('1'='1'--",
"admin') or ('1'='1'#",
"admin') or ('1'='1'/*",
"admin') or '1'='1",
"admin') or '1'='1'--",
"admin') or '1'='1'#",
"admin') or '1'='1'/*",
"1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055",
'admin" --',
'admin" #',
'admin"/*',
'admin" or "1"="1',
'admin" or "1"="1"--',
'admin" or "1"="1"#',
'admin" or "1"="1"/*',
'admin"or 1=1 or ""="',
'admin" or 1=1',
'admin" or 1=1--',
'admin" or 1=1#',
'admin" or 1=1/*',
'admin") or ("1"="1',
'admin") or ("1"="1"--',
'admin") or ("1"="1"#',
'admin") or ("1"="1"/*',
'admin") or "1"="1',
'admin") or "1"="1"--',
'admin") or "1"="1"#',
'admin") or "1"="1"/*',
'1234 " AND 1=0 UNION ALL SELECT "admin", "81dc9bdb52d04dc20036dbd8313ed055'
];


/*
  Errata and crap
  Form fields are not strings!
"<script >alert('hello');<script>",  will try and execute
'!@#$%^&*()_+<>:""\|',  single quotes in a list of double quotes questionable
when checking an address you need to allow a comma ?

For STR: !@#$%^&*()_+<>:''\|

checkAlphaMatch RET:"
STR: !@#$%^&*()_+<>:''\|
TEST: /[\x27\x2D\x2E\x30-\x39\x41-\x5a\x60\x61-\x7a\s\xC0-\xD6\xD8-\xF6\xF8-\xFF]+/
Match: Match

it really returns gjret [ "''"]; but it can't display it correctly

add _

MYsql  single quotes
% %
sql comments
' or '1'='1' -- '
' or '1'='1' ({ '
' or '1'='1' /* '

a';DROP TABLE users; SELECT * FROM userinfo WHERE 't' = 't

$query = sprintf("SELECT * FROM `Users` WHERE UserName='%s' AND Password='%s'",
                  mysql_real_escape_string($Username),
                  mysql_real_escape_string($Password));
mysql_query($query);
which prepends backslashes to the following characters: \x00, \n, \r, \, ', " and \x1a. This function must always (with few exceptions) be used to make data safe before
sending a query to MySQL

deny SELECT ON sys.sysobjects TO webdatabaselogon;
deny SELECT ON sys.objects TO webdatabaselogon;
deny SELECT ON sys.TABLES TO webdatabaselogon;
deny SELECT ON sys.views TO webdatabaselogon;

"Web Application Attack and Audit Framework" Developer(s) 	Andres Riancho
Website 	http://www.w3af.org/

w3af (short for web application attack and audit framework) is an open-source web application security scanner.
cross site scripting

Exploit examples
Attackers intending to exploit cross-site scripting vulnerabilities must approach each class of vulnerability differently. For each class, a specific attack vector is described here. The names below are technical terms, taken from the cast of characters commonly used in computer security.
Non-persistent:

    Alice often visits a particular website, which is hosted by Bob. Bob's website allows Alice to log in with a username/password pair and stores sensitive data, such as billing information.
    Mallory observes that Bob's website contains a reflected XSS vulnerability.
    Mallory crafts a URL to exploit the vulnerability, and sends Alice an email, enticing her to click on a link for the URL under false pretenses. This URL will point to Bob's website (either directly or through an iframe or ajax), but will contain Mallory's malicious code, which the website will reflect.
    Alice visits the URL provided by Mallory while logged into Bob's website.
    The malicious script embedded in the URL executes in Alice's browser, as if it came directly from Bob's server (this is the actual XSS vulnerability). The script can be used to send Alice's session cookie to Mallory. Mallory can then use the session cookie to steal sensitive information available to Alice (authentication credentials, billing info, etc.) without Alice's knowledge.

Persistent attack:

    Mallory posts a message with malicious payload to a social network.
    When Bob reads the message, Mallory's XSS steals Bob's cookie.
    Mallory can now hijack Bob's session and impersonate Bob.[16]

Zero-Length Matches

We saw that the anchors match at a position, rather than matching a character. This means that when a regex only
consists of one or more anchors, it can result in a zero-length match.
Depending on the situation, this can be very useful or undesirable.
Using ^\d*$ to test if the user entered a number (notice the use of the star instead of the plus),
would cause the script to accept an empty string as a valid input. See below.

However, we are trying to match a dollar sign, and the mighty dollar is a strange beast.
It is zero-width, so it will try to match the position before the current character.
It does not matter that this "character" is the void after the string. In fact, the dollar will check the current character.
It must be either a newline, or the void after the string, for $ to match the position before the current character.
Since that is the case after the example, the dollar matches successfully.

*/


var repStr1 = "nopqrstuvw";


function runIT()
{
  for (var i=0;i < inStrs2.length ; i++)
  {
    checkAlphaMatch(inStrs2[i]);
  }
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkSQL(inStrs[i]);
  }
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkAlphaMatch(inStrs[i]);
  }
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkPhone(inStrs[i]);
  }
  myDump("--------------------------");
  for (var i=0;i < inStrs.length ; i++)
  {
    checkZip(inStrs[i]);
  }
  myDump("--------------------------");
  for (var i=0;i < inStrs.length ; i++)
  {
    checkEmail(inStrs[i]);
  }
  myDump("--------------------------");

/*
  for (var i=0;i < inStrs.length ; i++)
  {
    hasLetter(inStrs[i]);
  }
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    stripNonDigits(inStrs[i]);
  }
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    stripChars(repStr1, inStrs[i]);
  }
*/

/* see checkAlphaMatch
  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    hasAlphaNumeric(inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    hasextAlphaNumeric( inStrs[i]);
  }
*/

  for (var i=0;i < inStrs.length ; i++)
  {
    checkDecNum( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkInt( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkCurr( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkAddr( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkName( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkFree( inStrs[i]);
  }

  myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkNotNull( inStrs[i]);
  }

 myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkDate( inStrs[i]);
  }

 myDump("--------------------------");

  for (var i=0;i < inStrs.length ; i++)
  {
    checkEmpty( inStrs[i]);
  }
}

//returns a new string without pattern, may not work with a newline
//stripChars( /:/, whatStr );  removes the first : , stripChars( /a/ig, whatStr ); removes all lower and upercase a

function stripChars(pattern, str)
{
  var gjret = str.replace(pattern,"");  // replace( old , new )
  myDump("stripChars &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; PATTERN:&nbsp;&nbsp; " + pattern);
}
//takes only the digits from the orginal str
function stripNonDigits(str)
{
  var gjret = str.replace(/[^0-9]/g,"");
  myDump("stripNonDigits &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + "/[^0-9]/g");
}

function hasLetter(str)
{
  var letterexp = /[a-z]/i;
  var gjret = letterexp.test(str);
  myDump("hasLetter &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + letterexp);
  return;
}
/*
function hasChar(str)
{
  var charexp = /./
  return charexp.test(str)
}
*/
//use one with hex codes
function hasextAlphaNumeric(str)
{
  //var letterexp = /[a-zA-Z0-9\.\-'`À-ÖØ-öø-ÿ\s]+'?/;
  //var letterexp = /^[a-zA-Z0-9\.\-'`À-ÖØ-öø-ÿ\s]$/; tried anchors to begin and end NG
  var letterexp = /[a-zA-Z0-9\.\-'`À-ÖØ-öø-ÿ\s]/;
  var gjret = letterexp.test(str);
  myDump("hasextAlpha &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + letterexp);
  return;
}

function hasAlphaNumeric(str)
{
  var letterexp = /[a-zA-Z0-9'\.\-\s]+/;
  var gjret = letterexp.test(str);
  myDump("hasAlpha &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + letterexp);
  return;
}

//look for zero or one only of '  \x27 prevent this "'double single quotes '" from passing
//  ? 	0 or 1
function checkAlphaMatch(str)
{
  try
  {
    //wip for a unambigous utf-8 out only iso portion hex test
                    //'     -     .   0  - 9    A    Z    `    a -  z  spaces  À-Ö       Ø-ö       ø-ÿ
              //\x27 \x2D \x2E \x30-\x39 \x41-\x5a \x60 \x61-\x7a \s\xC0-\xD6 \xD8-\xF6 \xF8-\xFF

    var letterexp = /[\x27\x2D\x2E\x30-\x39\x41-\x5a\x60\x61-\x7a\s\xC0-\xD6\xD8-\xF6\xF8-\xFF]+/;
    // notice s+  it returned a + (was not + 1 or more matchs var letterexp = /[\x27\x2D\x2E\x30-\x39\x41-\x5a\x60\x61-\x7a\s+\xC0-\xD6\xD8-\xF6\xF8-\xFF]+/;
    // try oifr zero or one of ' var letterexp = /[\x27\x2D\x2E\x30-\x39\x41-\x5a\x60\x61-\x7a\s\xC0-\xD6\xD8-\xF6\xF8-\xFF]+/;
    //  this is good -> var letterexp = /[a-zA-Z0-9\.\-'`À-ÖØ-öø-ÿ\s]+/;
    // above removes '? at end , the '? are unnessesary var letterexp = /[a-zA-Z0-9\.\-'`À-ÖØ-öø-ÿ\s]+'?/;
    // var letterexp = /[a-zA-Z0-9'\.\-\s]+/;
    var gjret = str.match(letterexp);
    var ok = ((gjret) && gjret[0].length == str.length) ? "Match" : "NoMatch";
    var singlequote = /\x27/g;

    if (ok === "Match")
    {
      var gjret2 = str.match(singlequote);
      if((gjret2) && gjret2.length > 1)
      {
        ok = "NoMatch";
        myDump( "CheckAlphaMatch &nbsp More than one single quote RET: &nbsp;" + gjret2 + "<br> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "<br> <span style='background-color:lightskyblue'> Match:" + ok + "</span>");
      }
      else
      {
        myDump("checkAlphaMatch &nbsp;&nbsp; RET: &nbsp;&nbsp; " + gjret + "<br> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "<br>&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + letterexp + "<br><span style='background-color:lightskyblue'> Match: " + ok + "</span>");
      }
    }
    else
    {
    myDump("checkAlphaMatch &nbsp;&nbsp; RET: &nbsp;&nbsp; " + gjret + "<br> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "<br>&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + letterexp + "<br><span style='background-color:lightskyblue'>Match: " + ok + "</span>");
    }
  }
    catch (theerror)
    {
      var wintxt = "\n" + " -- - " +  "\n" + "\n" + " " + " - - -  "  + "Regular Expression Error" +  " - - - " + "\n" + theerror.name + " - - -  " + " " +  theerror.message + " - - - " + "\n" + "\n" + " - - -  " ;
      alert(wintxt);
    }
}

function checkPhone(str)
{
  var phonexp = /^\d{3}[-]\d{3}[-]\d{4}(.*)?$/;
  var gjret =phonexp.test(str);
  myDump("checkPhone &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + phonexp);
}

//either 12345 or 12345-1234
function checkZip(str)
{
  if(str.length > 11)
  {
    myDump("checkZip &nbsp;&nbsp;RET:&nbsp;&nbsp; <span style='background-color:lightskyblue'>Length</span>&nbsp;&nbsp; STR:&nbsp;&nbsp; " + str );
    return;
  }

  //var zipexp = /(\d{5}([\-]\d{4})?)/;
  var zipexp = /^(\d{5}([\-]\d{4})?)$/;
  var gjret =zipexp.test(str);
  myDump("checkZip &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + zipexp);
}

//returns true if one of the words found, want !
function checkSQL(str)
{
 sqlexp = /(delete|drop|update|replace|kill|lock)/gi;
var gjret =sqlexp.test(str);
 myDump("checkSQL &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + sqlexp);
}

function checkEmail(str)
{
  var emailexp = /^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;
  var gjret =emailexp.test(str);
  myDump("checkEmail &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + emailexp);
}

//$ returns true for empty string
function checkDecNum(str)
{
  var re =/^[\d\.]*$/;
  var gjret =re.test(str);
  myDump("checkDecNum &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

// $ returns true for empty string
function checkInt(str)
{
  var re =/^\d*$/;
  var gjret =re.test(str);
  myDump("checkInt &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

//$ returns true for empty string
function checkCurr(str)
{
  var re =/^\$?\d*,?\.?\d{0,2}$/i;
  var gjret =re.test(str);
  myDump("checkCurr &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

//$ returns true for empty string  words
function checkAddr(str)
{
  var re =/^[\w- \.,#]*$/gi
  var gjret =re.test(str);
  myDump("checkAddr &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

//$ returns true for empty string  words
function checkName(str)
{
  var re =/^[a-z,\-\. ]*$/gi;
  var gjret =re.test(str);
  myDump("checkName &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

//$ returns true for empty string  words
function checkFree(str)
{
  var re =/^[\w\-\+\(\)\[\]\\/&, ]*$/i;
  var gjret =re.test(str);
  myDump("checkFreel &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}
// also  ! re = /^$/;
function checkNotNull(str)
{
  var   re = /.+/;
  var gjret =re.test(str);
  myDump("checkNotNull &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

// dates in the form 02-02-04 or 01/01/2004  or 3/1/7
//$returns true for empty string
function checkDate(str)
{
  re = /^(()|(\d{1,2}(\/|-)\d{1,2}(\/|-)\d{2,4}))$/;
  var gjret =re.test(str);
  myDump("checkDate &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

function checkEmpty(str)
{
  re = /^$/;
  var gjret =re.test(str);
  myDump("checkEmpty &nbsp;&nbsp; RET: &nbsp;&nbsp;<span style='background-color:lightskyblue'> " + gjret + "</span> &nbsp;&nbsp; STR:&nbsp;&nbsp; " + str + "&nbsp;&nbsp; TEST:&nbsp;&nbsp; " + re);
}

function myDump(str1)
{
  appendInnerHTML("theop", "<br>" + str1);
}

function appendInnerHTML(idin, myHTML)
{
    var myE= document.getElementById(idin);
    myE.innerHTML  = myE.innerHTML + myHTML;
}

</script>
</head>

<body id='testbod' onload="runIT();">

<div>
<a href="http://regexpal.com/">Steven Levithan tester</a>&nbsp;&nbsp;
<a href="http://www.w3schools.com/jsref/jsref_obj_regexp.asp">JS RegExp Object</a>&nbsp;&nbsp;
<a href="https://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/RegExp#Special_characters_in_regular_expressions">Good reference</a>&nbsp;&nbsp;
<a href="http://www.cheatography.com/davechild/cheat-sheets/regular-expressions/">D Child Cheat Sheet</a>&nbsp;&nbsp;
<a href="http://www.visibone.com/regular-expressions/">Visbone Cheat Sheet</a><br>
</div>

<div id="testplace" style="height:100%; width:100%; overflow-x:auto;overflow-y:auto;">
<p id='theop'> </p>
</div>

</body>
</html>

