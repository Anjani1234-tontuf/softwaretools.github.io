// (c)2012 Gary Johnson

function toggleHighLight(myEvent,myId)
{try
{var myClass=document.getElementById(myId).className;var temp=myClass.substr(7,10);if(myEvent=="m")
{document.getElementById(myId).className='buttonH'+temp;}
else if(myEvent=="o")
{document.getElementById(myId).className='buttonN'+temp;}}
catch(error)
{if(checkDebug())
{gjonerror(error,"toggleHighLight");}}
return false;}
function getCookieVal(offset)
{var endstr=document.cookie.indexOf(";",offset);if(endstr==-1)
endstr=document.cookie.length;return unescape(document.cookie.substring(offset,endstr));}
function getCookie(name)
{try
{var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1)
{begin=dc.indexOf(prefix);if(begin!==0)
return null;}
else
begin+=2;var end=document.cookie.indexOf(";",begin);if(end==-1)
end=dc.length;}
catch(error)
{gjonerror(error,"getCookie ");return 0;}
return unescape(dc.substring(begin+prefix.length,end));}
function setCookie(name,value,expires,path,domain,secure)
{var curCookie=name+"="+escape(value)+
((expires)?"; expires="+expires.toGMTString():"")+
((path)?"; path="+path:"")+
((domain)?"; domain="+domain:"")+
((secure)?"; secure":"");document.cookie=curCookie;}
function deleteCookie(name,path,domain)
{try
{if(getCookie(name))
{document.cookie=name+"="+
((path)?"; path="+path:"")+
((domain)?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT";}
else
{doMessage('Error in deleteCookie trying to delete non existent cookie '+name);}}
catch(error)
{gjonerror(error,"deleteCookie");}}
function getCookieItem(ckName,ckItem)
{var ckValue=unescape(getCookie(ckName));var ckOffset=ckValue.indexOf(ckItem);if(ckOffset==-1)
{return null;}
else
{var endStr=ckValue.indexOf("&",ckOffset);if(endStr==-1)
{var theItemOffset=ckValue.indexOf("=",ckOffset)+1;if(theItemOffset==-1)
{return null;}
else
{return ckValue.substring(theItemOffset,ckValue.length);}}
else
{var thePair=ckValue.substring(ckOffset,endStr);var theItemOffset=thePair.indexOf("=")+1;return(thePair.substring(theItemOffset,endStr));}}
return null;}
function checkDebugD()
{try
{if(checkDebug())
{alert('debugging on');}
else
{alert('debugging off');}}
catch(error)
{gjonerror(error,"checkDebugD");return false;}
return true;}
function checkDebug()
{var debugCD;try
{debugCD=getCookieItem("gj53runOptions","DebugHTML");if(debugCD==null)
{return false;}
if(debugCD===undefined||debugCD===""||debugCD==="0"||debugCD===false||debugCD==="false")
{return false;}
else
{return true;}}
catch(err)
{gjonerror(err," checkDebug ");}
return false;}
function testInteger(number)
{try
{number=number.toString();if((number.length===0)||(number.length===undefined)){return false;}
for(var i=0;i<number.length;i++){var oneChar=number.charAt(i);if(oneChar>="0"&&oneChar<="9"){continue;}else{return false;}}}
catch(error){gjonerror(error,"testInteger");return false;}
return true;}
function fixFileUrl(u)
{var windows;windows=(navigator.platform.indexOf('Win')!=-1);u=u.substr(windows?8:7);u=unescape(u);if(windows)
{u=u.replace(/\//g,'\\');u=u.replace(/\|/g,':');}
return u;}
function checkQuote(instr)
{if(instr.length===0)
return false;try
{if(instr.indexOf("'")!=-1)
{return false;}
else
if(instr.indexOf('"')!=-1)
{return false;}}
catch(error)
{gjonerror(error,"checkQuote ");}
return true;}
function checkValidFileName(instr)
{if(instr.length===0)
return false;try
{if(instr.indexOf("*")!=-1)
{return false;}
else
if(instr.indexOf("/")!=-1)
{return false;}
else
if(instr.indexOf(":")!=-1)
{return false;}
else
if(instr.indexOf(";")!=-1)
{return false;}
else
if(instr.indexOf("?")!=-1)
{return false;}
else
if(instr.indexOf("\\")!=-1)
{return false;}
else
if(instr.indexOf("|")!=-1)
{return false;}
else
if(instr.indexOf(",")!=-1)
{return false;}
else
if(instr.indexOf("<")!=-1)
{return false;}
else
if(instr.indexOf(">")!=-1)
{return false;}}
catch(error)
{gjonerror(error,"checkValidFileName ");}
return true;}
function checkValidPath(strin)
{if((navigator.platform!="Win32")&&(navigator.platform!="OS/2"))
{return true;}
var re=":";try
{var strPath=new String(Trim(strin));strPath=strPath.toUpperCase();var check1=strPath.indexOf(re);if(check1>0)
{var strDrive=strPath.substring(0,check1);if(strDrive.length!=1)
{alert('we do not support UNC paths at this point, Please enter a valid path like C:\\CookBook input='+strDrive);return false;}
re=/^[A-Z ]*$/;if(!(re.test(strDrive)))
{alert('not A - Z');return false;}
re="\\";var check2=strPath.indexOf(re);var check3=(check1>check2?check1:check2);var fileNM=strPath.substring((check3+1),strPath.length);var myArray=fileNM.split(/\\/);if(myArray.length===0)
{if(!(checkValidFileName(fileNM)))
{alert(' * / : ; ? \ | < >  and control characters are invalid in file names ->'+fileNM);return false;}
else
{return true;}}
else
{for(var i=0;i<myArray.length;i++)
{if(!(checkValidFileName(myArray[i])))
{alert('-> * / : ; ? \ | < >  and control characters are invalid in file names ->'+myArray[i]);return false;}}
return true;}}
else
if(!(checkValidFileName(strin)))
{alert(' * / : ; ? \ | < >  and control characters are invalid in file names -> '+strin);return false;}}
catch(e)
{gjonerror(e+"checkValidPath input = "+strin);}
return true;}
function checkWild(instr)
{if(instr.length===0)
return false;try
{if(instr.indexOf("%")>=0)
{return true;}}
catch(error)
{gjonerror(error,"checkWild ");}
return false;}
function displayTSS(event)
{try
{setToggleTop(event);if(isGecko())
{self.statusbar.visible=false;}
StartTSS();}
catch(error)
{gjonerror(error,"displayTSS ");}}
function StartTSS()
{var mytop;var myleft;try
{if(isGecko())
{mytop=parseInt(document.getElementById("TSSinfo").style.top);}
else if(isIE())
{myleft=document.getElementById("TSSinfo").style.posLeft;}
else
{alert('unknown browser');return;}
if(isGecko())
{if(mytop>=getToggleTop())
{toggleId=window.setInterval("TSSUp()",1);}
else
{document.getElementById("TSSinfo").style.visibility="visible";toggleId=window.setInterval("TSSDown()",1);}}
else if(isIE())
{if(myleft>=getToggleTop())
{toggleId=window.setInterval("TSSUp()",1);}
else
{document.getElementById("TSSinfo").style.visibility="visible";toggleId=window.setInterval("TSSDown()",1);}}}
catch(error)
{gjonerror(error,"StartTSS ");}}
function TSSDown()
{var top;var left;try
{if(isGecko())
{top=parseInt(document.getElementById("TSSinfo").style.top);top+=25;var sztop=top+"px";document.getElementById("TSSinfo").style.top=sztop;if(top>=getToggleTop())
{window.clearInterval(toggleId);}}
else if(isIE())
{left=document.getElementById("TSSinfo").style.posLeft;left+=7;document.getElementById("TSSinfo").style.posLeft=left;if(left>=getToggleTop())
{window.clearInterval(toggleId);}}
else
{alert('unknown browser');}}
catch(error)
{gjonerror(error,"TSSDown");}}
function TSSUp()
{var top;var left;try
{if(isGecko())
{top=parseInt(document.getElementById("TSSinfo").style.top);top-=25;var sztop=top+"px";document.getElementById("TSSinfo").style.top=sztop;if(top<=getToggleBottom())
{document.getElementById("TSSinfo").style.visibility="hidden";window.clearInterval(toggleId);}}
else
{left=document.getElementById("TSSinfo").style.posLeft;left-=7;document.getElementById("TSSinfo").style.posLeft=left;if(left<=getToggleBottom())
{document.getElementById("TSSinfo").style.visibility="hidden";window.clearInterval(toggleId);}}}
catch(error)
{gjonerror(error,"TSSUp ");}}
function getToggleTop()
{return vtoggleTop;}
function cbPrint()
{var theDivs=document.getElementsByTagName('DIV');for(var i=0;i<theDivs.length;i++)
{var aDiv=theDivs[i];var temp=aDiv.id;var check1=temp.substr(0,1);if(check1=='h')
{if(aDiv.style.display=='none')
{aDiv.style.display='block';}}
if(aDiv.className=="MyButton")
{aDiv.style.display='none';}}
var theInputs=document.getElementsByTagName('INPUT');for(var i=0;i<theInputs.length;i++)
{var aInputs=theInputs[i];aInputs.style.display='none';}
var theAs=document.getElementsByTagName('A');for(var i=0;i<theAs.length;i++)
{var aAs=theAs[i];aAs.style.display='none';}
return true;}
function DisplayModifedDate(what,id)
{toggleHighLight(what,id);if(what=='o')
{document.getElementById(id).value="Show Date Last Modified";}
else
{var lastmod=parent.document.lastModified;var lastmoddate=Date.parse(lastmod);var DisplayDate;if(lastmoddate===0)
{DisplayDate="Last modified: Unknown";}
else
{DisplayDate="Last modified: "+lastmod;}
document.getElementById(id).value=DisplayDate;}}
function getTimeStamp()
{var now=new Date();var hour=now.getHours();var min=now.getMinutes();var sec=now.getSeconds();if(min<=9)
{min="0"+min;}
if(sec<=9)
{sec="0"+sec;}
if(hour>12)
{hour=hour-12;ampm="PM";}
else
{ampm="AM";}
if(hour==12)
{ampm="PM";}
if(hour==00)
{hour="12";}
if(hour<=9)
{hour="0"+hour;}
var msg1=hour;msg1+=':'+min;msg1+=':'+sec+"."+now.getMilliseconds();msg1+=' '+ampm+' ';msg1=" "+msg1+" ";return msg1;}
function changeAttribute(elementId,attrName,newData)
{try
{if(document.getElementById)
{var el=document.getElementById(elementId);el.setAttribute(attrName,newData);}}
catch(error)
{gjonerror(error,"changeAttribute");}}
function getCBdir()
{try
{netscape.security.PrivilegeManager.enablePrivilege("UniversalPreferencesRead");var fp=navigator.preference("gj53run.URL1");}
catch(err)
{alert("Permission to read preferences was denied.");}
return fp;}
function getCBPath(which,filein,etc)
{var DEFAULTURL1="file:///"+getCBdir();var os=gjwhichOS();if(os=='w')
{if(which=="root")
{var DEFAULTSUBDIR1="";}
else if(which=="tools")
{var DEFAULTSUBDIR1="\\XXSoftwareTools\\";}
else if(which=="dict")
{var DEFAULTSUBDIR1="\\TermsDictionaryGlossary\\";}
else if(which=="hints")
{var DEFAULTSUBDIR1="\\FoodFactsHintsTips\\";}
else if(which=="bev")
{var DEFAULTSUBDIR1="\\Beverages\\";}
else if(which=="safe")
{var DEFAULTSUBDIR1="\\FoodSafety\\";}
else if(which=="herb")
{var DEFAULTSUBDIR1="\\HerbsSpicesSeasonings\\";}
else if(which=="equip")
{var DEFAULTSUBDIR1="\\KitchenEquipment\\";}
else if(which=="pantry")
{var DEFAULTSUBDIR1="\\pantry\\";}
else if(which=="pics")
{var DEFAULTSUBDIR1="\\Pictures\\";}
else if(which=="charts")
{var DEFAULTSUBDIR1="\\ToolsChartsTables\\";}
else
{var DEFAULTSUBDIR1="";}}
else
{if(which=="root")
{var DEFAULTSUBDIR1="";}
else if(which=="tools")
{var DEFAULTSUBDIR1="/XXSoftwareTools/";}
else if(which=="dict")
{var DEFAULTSUBDIR1="/TermsDictionaryGlossary/";}
else if(which=="hints")
{var DEFAULTSUBDIR1="/FoodFactsHintsTips/";}
else if(which=="bev")
{var DEFAULTSUBDIR1="/Beverages/";}
else if(which=="safe")
{var DEFAULTSUBDIR1="/FoodSafety/";}
else if(which=="herb")
{var DEFAULTSUBDIR1="/HerbsSpicesSeasonings/";}
else if(which=="equip")
{var DEFAULTSUBDIR1="/KitchenEquipment/";}
else if(which=="pantry")
{var DEFAULTSUBDIR1="/pantry/";}
else if(which=="pics")
{var DEFAULTSUBDIR1="/Pictures/";}
else if(which=="charts")
{var DEFAULTSUBDIR1="/ToolsChartsTables/";}
else
{var DEFAULTSUBDIR1="";}}
var myurl=DEFAULTURL1+DEFAULTSUBDIR1+filein;return myurl;}
function getOSDirDelimter()
{var nos=gjwhichOS();var ndelimt;if(nos=='w')
{ndelimt='\\';}
else
{ndelimt='/';}
return ndelimt;}
function computeMillisec(aDate)
{var tstring=aDate.toUTCString();var nowMilliseconds=Date.parse(tstring)+(aDate.getTimezoneOffset()*(60*1000));return nowMilliseconds;}
function getFFpref(which)
{try
{netscape.security.PrivilegeManager.enablePrivilege("UniversalPreferencesRead");var fp=navigator.preference(which);}
catch(err)
{alert("Permission to read preferences was denied.");return"Error in  getFFpref";}
return fp;}
function getCompStyle(idin,cstyle)
{var myE=document.getElementById(idin);if(isGecko())
{if(document.defaultView)
{if(cstyle==='')
{cstyle=null;}
var mystyle=document.defaultView.getComputedStyle(myE,'');return mystyle.getPropertyValue(cstyle);}
else
{if(checkDebug())
{alert('getCompStyle document.defaultView does not exist');}
return false;}}
else if(isIE())
{var ieCstyle=getInterCap(cstyle);var ieValue=myE.currentStyle+'.'+ieCstyle;return ieValue;}
else if(checkDebug())
{alert('getCompStyle not done for this browser');return false;}
return false;}
function myToggleBars()
{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserWrite");((window.menubar.visible)?window.menubar.visible=false:window.menubar.visible=true);((window.toolbar.visible)?window.toolbar.visible=false:window.toolbar.visible=true);((window.personalbar.visible)?window.personalbar.visible=false:window.personalbar.visible=true);((window.locationbar.visible)?window.locationbar.visible=false:window.locationbar.visible=true);((window.scrollbars.visible)?window.scrollbars.visible=false:window.scrollbars.visible=true);((window.statusbar.visible)?window.statusbar.visible=false:window.statusbar.visible=true);}
function setUIMin(onoff)
{var expdate=new Date();expdate.setTime(expdate.getTime()+(24*60*60*1000*2000));setCookie("UIMin",onoff,expdate,"/",null,false);}
var MAX_DUMP_DEPTH=10;function dumpObj(obj,name,indent,depth){if(depth>MAX_DUMP_DEPTH){return indent+name+": <Maximum Depth Reached>\n";}
if(typeof obj=="object"){var child=null;var output=indent+name+"\n";indent+="\t";for(var item in obj){try{child=obj[item];}catch(e){child="<Unable to Evaluate>";}
if(typeof child=="object"){output+=dumpObj(child,item,indent,depth+1);}else{output+=indent+item+": "+child+"\n";}}
return output;}else{return obj;}}