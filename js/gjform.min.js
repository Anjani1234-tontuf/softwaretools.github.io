// Copyright (c) 2000-2012 by Gary Johnson

var myStrike=0;function clearOP()
{changeInnerHTML("theop","");}
function saveText()
{this.itemCount=0;this.key=new Array();this.values=new Array();}
saveText.prototype={getValueAt:function getValueAt(index)
{return this.values[index];},getValueFor:function getValueFor(keyin)
{for(var it=0;it<this.itemCount;it++)
{if(this.key[it]==keyin)
{return this.values[it];}}
return'~0';},storeIt:function storeIt(keyin,valuein)
{this.key.push(keyin);this.values.push(valuein);this.itemCount++;}}
var theText=new saveText();function myReset(formnum,idin)
{var root=document.getElementById(idin);var tds=root.getElementsByTagName("p");var thisTD;var len;var strID;for(var ri=0;ri<tds.length;ri++)
{thisTD=tds[ri];len=thisTD.id.length;if((thisTD.id.indexOf("op")==0)||(len==0))
{continue;}
else
{len=thisTD.id.length;strID=thisTD.id.substring(len-2,len);if(strID=='op')
{changeInnerHTML(thisTD.id,"");}}}
document.forms[formnum].reset();}
function mySaveText(idin)
{var root=document.getElementById(idin);var tds=root.getElementsByTagName("p");var thisTD;var len;var strID;for(var si=0;si<tds.length;si++)
{thisTD=tds[si];len=thisTD.id.length;if((len!=0)&&(thisTD.id.indexOf("op")!=0))
{strID=thisTD.id.substring(len-2,len);if(strID=='op')
{theText.storeIt(thisTD.id,returnInnerHTML(thisTD.id));changeInnerHTML("theop",returnInnerHTML("theop")+"<br>mst"+returnInnerHTML(thisTD.id));}}}}
function myRestoreText(idin)
{var root=document.getElementById(idin);var tds=root.getElementsByTagName("p");var thisTD;var len;var strID;var newText;var iam;var myCount=0;for(var pi=0;pi<tds.length;pi++)
{thisTD=tds[pi];len=thisTD.id.length;if((len!=0)&&(thisTD.id.indexOf("op")!=0))
{strID=thisTD.id.substring(len-2,len);if(strID=='op')
{newText=returnInnerHTML(thisTD.id)
changeInnerHTML("theop",returnInnerHTML("theop")+"<br>mrt1 "+myCount+" "+newText);changeInnerHTML("theop",returnInnerHTML("theop")+"<br>mrt2 "+myCount+" index "+theText.getValueAt(myCount++)+" key "+theText.getValueFor(thisTD.id));iam=newText.substring(0,3);if(iam!="I am")
{changeInnerHTML(thisTD.id,theText.getValueFor(thisTD.id));}
else
{changeInnerHTML(thisTD.id,newText);}}}}}
function checkValidFormValue(idin,stringin)
{var illegalChars=new Array('<','>','{','}','[',']','^','&','*','#','~','+','$','(',')','%','=','"');for(var i=0;i<illegalChars.length;i++)
{if(stringin.indexOf(illegalChars[i],0)!=-1)
{setError(nname,'The following character cannot be used in a search string: '+illegalChars[i]+'  Please modify this character and resubmit.','');return false;}}
delete illegalChars;return true;}
function validateForm(formIn,idin)
{var root=document.getElementById(idin);var inputElements=new Array('select','input','textarea');var theReturn=true;var cbObj;try
{for(var i=0;i<inputElements.length;i++)
{var oNodeList=root.getElementsByTagName(inputElements[i]);var nodeCount=oNodeList.length;changeInnerHTML("theop",returnInnerHTML("theop")+"<br>5"+"There are "+nodeCount+" nodes ");var thisName='';for(var n=0;n<nodeCount;n++)
{var node=oNodeList.item(n);changeInnerHTML("theop",returnInnerHTML("theop")+"<br>4"+"number "+(n+1)+", local name: "+node.localName+" "+node.type+" "+node.name);if(isIE())
{cbObj=node.tagName;}
else
{cbObj=node.localName;}
if(cbObj=="INPUT")
{var isReq=node.name.substr(0,1);var len=node.name.length;if(isReq=="R")
{if(len<5)
{alert('aborting -> id name to short in form : '+node.name);return false;}
if(node.type=="radio")
{if(thisName==node.name)
{continue;}
else
{thisName=node.name
if(!checkRadio(formIn,node.name))
{theReturn=false;}}}
if(node.type=="text")
{if(node.name=="REmail")
{if(!validateEmail(node.name,node.name.value))
{theReturn=false;}}
else if(node.name=="RPhone")
{if(!validatePhone(node.name,node.name.value))
{theReturn=false;}}
else
{if(!checkText(formIn,node.name))
{theReturn=false;}}}}}
if(cbObj=="SELECT")
{var isReq=node.name.substr(0,1);var len=node.name.length;if(isReq=="R")
{if(len<5)
{alert('aborting -> id name to short in form : '+node.name);return false}
if(!validateState(formIn,node.name))
{theReturn=false;}}}
if(cbObj=="TEXTAREA")
{var isReq=node.name.substr(0,1);var len=node.name.length;if(isReq=="R")
{if(len<5)
{alert('aborting -> id name to short in form : '+node.name);return false;}
alert('Textare not done yet');}}}}
mySaveText(idin);}
catch(err)
{gjonerror(err," validateForm for "+idin);}
return theReturn;}
function checkRadio(formIn,nname)
{var theField='H'+nname;var theE=document.getElementById(theField);if(theE)
{if(theE.value!=1)
{setError(nname,'I am required, please enter me ','');return false;}}
else
{alert('checkRadio how did I get here '+nname);}
return true;}
function checkText(formIn,nname)
{var theE=document.getElementById(nname);if(theE)
{if(theE.value.length<1)
{setError(nname,'I am required, please enter me ','');return false;}}
else
{alert('checkText how did I get here '+nname);}
return true;}
function setResponse(where,what,effect)
{var newWhat=what;try
{setClass(where,"italicblue");var isReq=where.substr(0,1);if(isReq=="R")
{var len=where.length;var realId=where.substr(0,(len-2));var realHidden="H"+realId;var theE=document.getElementById(realHidden);if(theE)
{theE.value=1;}
else
{alert("setResponse how did I get here where: "+where);}}
if(what=="LIMITED")
{newWhat='You will like the food dictionary and the widgets; however, the recipes are not for you at this time';setClass(where,"CBwarn")}
else if(what=="No")
{newWhat='You might like the widgets; however, the recipes and dictionary are not for you at this time';setClass(where,"CBerror")}
if(effect=="COUNTER")
{myStrike++;newWhat=newWhat+myStrike;setClass(where,"CBwarn")}
changeInnerHTML(where,newWhat);}
catch(err)
{gjonerror(err,"setResponse where"+where+" what "+what);}}
function setError(where,what,effect)
{try
{var realId=where+"op";var theE=document.getElementById(realId);if(theE)
{setClass(realId,"CBerror");changeInnerHTML(realId,what);}
else
{alert("setError how did I get here where: "+where+" what "+what);}}
catch(err)
{gjonerror(err,"setError where"+where+" what "+what);}}
function clearError(where,what,effect)
{try
{var realId=where+"op";var theE=document.getElementById(realId);if(theE)
{setClass(realId,"td1p");changeInnerHTML(realId,what);}
else
{alert("setError how did I get here where: "+where+" what "+what);}}
catch(err)
{gjonerror(err,"setError where"+where+" what "+what);}}
function validatePhone(idin,datain)
{try
{var theE=document.getElementById(idin);if(theE.value.length>0)
{var phonestring=theE.value;if(!checkValidFormValue(idin,phonestring))
{setError(idin,'invalid characters in phone ','');return false;}}
else
{setError(idin,'I am required, please enter me ','');}}
catch(err)
{gjonerror(err,"validatePhone error for : "+idin);}
return true;}
function validateEmail(idin,datain)
{var emailstring=document.getElementById(idin).value;var ampIndex=emailstring.indexOf("@");if(ampIndex==-1)
{setError(idin,"An email address should have an @!","");return false;}
var afterAmp=emailstring.substring((ampIndex+1),emailstring.length);var dotIndex=afterAmp.indexOf(".");if(dotIndex==-1)
{setError(idin,"An email address should have a . after the @ for the domain name!","");return false;}
dotIndex=dotIndex+ampIndex+1;afterAmp=emailstring.substring((ampIndex+1),dotIndex);var afterDot=emailstring.substring((dotIndex+1),emailstring.length);var beforeAmp=emailstring.substring(0,(ampIndex));var regex=/\;|#|\$|%|\^|&|\*|\(|\)|\+|\\|\/|\?|>|<|\{|\}|\,|\[|\]|\`|\|/;if((emailstring.length>5)&&(afterAmp.length>0)&&(beforeAmp.length>1)&&(afterDot.length>1)&&!(regex.test(emailstring)))
{return true;}
else
{setError(idin,"Please check your&quot;re email address!","");return false;}}
function validateState(formIn,nname)
{if(formIn.RState.selectedIndex==0)
{setError(nname,"Please selext a state!","");return false;}
else
{return true;}}
function submitIt(formIn,idin)
{try
{mySaveText(idin);if(validateForm(formIn,idin))
{alert('Victory');}
else
{alert('still false');myRestoreText(idin);}}
catch(err)
{gjonerror(err,"submitIt");}
return false}